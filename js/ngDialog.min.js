/*! ng-dialog - v0.5.5 (https://github.com/likeastore/ngDialog) */
!function(a,b){"undefined"!=typeof module&&module.exports?"undefined"==typeof angular?(b(require("angular")),module.exports="ngDialog"):(b(angular),module.exports="ngDialog"):"function"==typeof define&&define.amd?define(["angular"],b):b(a.angular)}(this,function(a){"use strict";var b=a.module("ngDialog",[]),c=a.element,d=a.isDefined,e=(document.body||document.documentElement).style,f=d(e.animation)||d(e.WebkitAnimation)||d(e.MozAnimation)||d(e.MsAnimation)||d(e.OAnimation),g="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",h="ngdialog-disabled-animation",i={html:!1,body:!1},j={},k=[],l=!1;return b.provider("ngDialog",function(){var b=this.defaults={className:"ngdialog-theme-default",disableAnimation:!1,plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0,trapFocus:!0,preserveFocus:!0,ariaAuto:!0,ariaRole:null,ariaLabelledById:null,ariaLabelledBySelector:null,ariaDescribedById:null,ariaDescribedBySelector:null};this.setForceHtmlReload=function(a){i.html=a||!1},this.setForceBodyReload=function(a){i.body=a||!1},this.setDefaults=function(c){a.extend(b,c)};var d,e=0,m=0,n={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector",function(o,p,q,r,s,t,u,v,w,x){var y=[],z={onDocumentKeydown:function(a){27===a.keyCode&&A.close("$escape")},activate:function(a){var b=a.data("$ngDialogOptions");b.trapFocus&&(a.on("keydown",z.onTrapFocusKeydown),y.body.on("keydown",z.onTrapFocusKeydown))},deactivate:function(a){a.off("keydown",z.onTrapFocusKeydown),y.body.off("keydown",z.onTrapFocusKeydown)},deactivateAll:function(b){a.forEach(b,function(b){var c=a.element(b);z.deactivate(c)})},setBodyPadding:function(a){var b=parseInt(y.body.css("padding-right")||0,10);y.body.css("padding-right",b+a+"px"),y.body.data("ng-dialog-original-padding",b),t.$broadcast("ngDialog.setPadding",a)},resetBodyPadding:function(){var a=y.body.data("ng-dialog-original-padding");a?y.body.css("padding-right",a+"px"):y.body.css("padding-right",""),t.$broadcast("ngDialog.setPadding",0)},performCloseDialog:function(a,b){var c=a.data("$ngDialogOptions"),e=a.attr("id"),g=j[e];if(g){if("undefined"!=typeof v.Hammer){var h=g.hammerTime;h.off("tap",d),h.destroy&&h.destroy(),delete g.hammerTime}else a.unbind("click");1===m&&y.body.unbind("keydown",z.onDocumentKeydown),a.hasClass("ngdialog-closing")||(m-=1);var i=a.data("$ngDialogPreviousFocus");i&&i.focus&&i.focus(),t.$broadcast("ngDialog.closing",a,b),m=0>m?0:m,f&&!c.disableAnimation?(g.$destroy(),a.addClass("ngdialog-closing"),setTimeout(function(){z.closeDialogElement(a,b)},500)):(g.$destroy(),z.closeDialogElement(a,b)),n[e]&&(n[e].resolve({id:e,value:b,$dialog:a,remainingDialogs:m}),delete n[e]),j[e]&&delete j[e],k.splice(k.indexOf(e),1),k.length||(y.body.unbind("keydown",z.onDocumentKeydown),l=!1)}},closeDialogElement:function(a,b){a.remove(),0===m&&(y.html.removeClass("ngdialog-open"),y.body.removeClass("ngdialog-open"),z.resetBodyPadding()),t.$broadcast("ngDialog.closed",a,b)},closeDialog:function(b,c){var d=b.data("$ngDialogPreCloseCallback");if(d&&a.isFunction(d)){var e=d.call(b,c);a.isObject(e)?e.closePromise?e.closePromise.then(function(){z.performCloseDialog(b,c)}):e.then(function(){z.performCloseDialog(b,c)},function(){}):e!==!1&&z.performCloseDialog(b,c)}else z.performCloseDialog(b,c)},onTrapFocusKeydown:function(b){var c,d=a.element(b.currentTarget);if(d.hasClass("ngdialog"))c=d;else if(c=z.getActiveDialog(),null===c)return;var e=9===b.keyCode,f=b.shiftKey===!0;e&&z.handleTab(c,b,f)},handleTab:function(a,b,c){var d=z.getFocusableElements(a);if(0===d.length)return void(document.activeElement&&document.activeElement.blur());var e=document.activeElement,f=Array.prototype.indexOf.call(d,e),g=-1===f,h=0===f,i=f===d.length-1,j=!1;c?(g||h)&&(d[d.length-1].focus(),j=!0):(g||i)&&(d[0].focus(),j=!0),j&&(b.preventDefault(),b.stopPropagation())},autoFocus:function(a){var b=a[0],d=b.querySelector("*[autofocus]");if(null===d||(d.focus(),document.activeElement!==d)){var e=z.getFocusableElements(a);if(e.length>0)return void e[0].focus();var f=z.filterVisibleElements(b.querySelectorAll("h1,h2,h3,h4,h5,h6,p,span"));if(f.length>0){var g=f[0];c(g).attr("tabindex","-1").css("outline","0"),g.focus()}}},getFocusableElements:function(a){var b=a[0],c=b.querySelectorAll(g),d=z.filterTabbableElements(c);return z.filterVisibleElements(d)},filterTabbableElements:function(a){for(var b=[],d=0;d<a.length;d++){var e=a[d];"-1"!==c(e).attr("tabindex")&&b.push(e)}return b},filterVisibleElements:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];(d.offsetWidth>0||d.offsetHeight>0)&&b.push(d)}return b},getActiveDialog:function(){var a=document.querySelectorAll(".ngdialog");return 0===a.length?null:c(a[a.length-1])},applyAriaAttributes:function(a,b){if(b.ariaAuto){if(!b.ariaRole){var c=z.getFocusableElements(a).length>0?"dialog":"alertdialog";b.ariaRole=c}b.ariaLabelledBySelector||(b.ariaLabelledBySelector="h1,h2,h3,h4,h5,h6"),b.ariaDescribedBySelector||(b.ariaDescribedBySelector="article,section,p")}b.ariaRole&&a.attr("role",b.ariaRole),z.applyAriaAttribute(a,"aria-labelledby",b.ariaLabelledById,b.ariaLabelledBySelector),z.applyAriaAttribute(a,"aria-describedby",b.ariaDescribedById,b.ariaDescribedBySelector)},applyAriaAttribute:function(a,b,d,e){if(d&&a.attr(b,d),e){var f=a.attr("id"),g=a[0].querySelector(e);if(!g)return;var h=f+"-"+b;return c(g).attr("id",h),a.attr(b,h),h}},detectUIRouter:function(){try{return a.module("ui.router"),!0}catch(b){return!1}},getRouterLocationEventName:function(){return z.detectUIRouter()?"$stateChangeSuccess":"$locationChangeSuccess"}},A={__PRIVATE__:z,open:function(f){function g(a,b){return t.$broadcast("ngDialog.templateLoading",a),s.get(a,b||{}).then(function(b){return t.$broadcast("ngDialog.templateLoaded",a),b.data||""})}function i(b){return b?a.isString(b)&&o.plain?b:"boolean"!=typeof o.cache||o.cache?g(b,{cache:p}):g(b,{cache:!1}):"Empty template"}var o=a.copy(b),B=++e,C="ngdialog"+B;k.push(C),f=f||{},a.extend(o,f);var D;n[C]=D=r.defer();var E;j[C]=E=a.isObject(o.scope)?o.scope.$new():t.$new();var F,G,H=a.extend({},o.resolve);return a.forEach(H,function(b,c){H[c]=a.isString(b)?x.get(b):x.invoke(b,null,null,c)}),r.all({template:i(o.template||o.templateUrl),locals:r.all(H)}).then(function(b){var e=b.template,f=b.locals;o.showClose&&(e+='<div class="ngdialog-close"></div>');var g=o.overlay?"":" ngdialog-no-overlay";if(F=c('<div id="ngdialog'+B+'" class="ngdialog'+g+'"></div>'),F.html(o.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content" role="document">'+e+"</div>":'<div class="ngdialog-content" role="document">'+e+"</div>"),F.data("$ngDialogOptions",o),E.ngDialogId=C,o.data&&a.isString(o.data)){var i=o.data.replace(/^\s*/,"")[0];E.ngDialogData="{"===i||"["===i?a.fromJson(o.data):o.data,E.ngDialogData.ngDialogId=C}else o.data&&a.isObject(o.data)&&(E.ngDialogData=o.data,E.ngDialogData.ngDialogId=C);if(o.className&&F.addClass(o.className),o.disableAnimation&&F.addClass(h),G=o.appendTo&&a.isString(o.appendTo)?a.element(document.querySelector(o.appendTo)):y.body,z.applyAriaAttributes(F,o),o.preCloseCallback){var j;a.isFunction(o.preCloseCallback)?j=o.preCloseCallback:a.isString(o.preCloseCallback)&&E&&(a.isFunction(E[o.preCloseCallback])?j=E[o.preCloseCallback]:E.$parent&&a.isFunction(E.$parent[o.preCloseCallback])?j=E.$parent[o.preCloseCallback]:t&&a.isFunction(t[o.preCloseCallback])&&(j=t[o.preCloseCallback])),j&&F.data("$ngDialogPreCloseCallback",j)}if(E.closeThisDialog=function(a){z.closeDialog(F,a)},o.controller&&(a.isString(o.controller)||a.isArray(o.controller)||a.isFunction(o.controller))){var k;o.controllerAs&&a.isString(o.controllerAs)&&(k=o.controllerAs);var n=w(o.controller,a.extend(f,{$scope:E,$element:F}),!0,k);o.bindToController&&a.extend(n.instance,{ngDialogId:E.ngDialogId,ngDialogData:E.ngDialogData,closeThisDialog:E.closeThisDialog}),F.data("$ngDialogControllerController",n())}if(u(function(){var a=document.querySelectorAll(".ngdialog");z.deactivateAll(a),q(F)(E);var b=v.innerWidth-y.body.prop("clientWidth");y.html.addClass("ngdialog-open"),y.body.addClass("ngdialog-open");var c=b-(v.innerWidth-y.body.prop("clientWidth"));c>0&&z.setBodyPadding(c),G.append(F),z.activate(F),o.trapFocus&&z.autoFocus(F),o.name?t.$broadcast("ngDialog.opened",{dialog:F,name:o.name}):t.$broadcast("ngDialog.opened",F)}),l||(y.body.bind("keydown",z.onDocumentKeydown),l=!0),o.closeByNavigation){var p=z.getRouterLocationEventName();t.$on(p,function(){z.closeDialog(F)})}if(o.preserveFocus&&F.data("$ngDialogPreviousFocus",document.activeElement),d=function(a){var b=o.closeByDocument?c(a.target).hasClass("ngdialog-overlay"):!1,d=c(a.target).hasClass("ngdialog-close");(b||d)&&A.close(F.attr("id"),d?"$closeButton":"$document")},"undefined"!=typeof v.Hammer){var r=E.hammerTime=v.Hammer(F[0]);r.on("tap",d)}else F.bind("click",d);return m+=1,A}),{id:C,closePromise:D.promise,close:function(a){z.closeDialog(F,a)}}},openConfirm:function(b){var d=r.defer(),e={closeByEscape:!1,closeByDocument:!1};a.extend(e,b),e.scope=a.isObject(e.scope)?e.scope.$new():t.$new(),e.scope.confirm=function(a){d.resolve(a);var b=c(document.getElementById(f.id));z.performCloseDialog(b,a)};var f=A.open(e);return f.closePromise.then(function(a){return a?d.reject(a.value):d.reject()}),d.promise},isOpen:function(a){var b=c(document.getElementById(a));return b.length>0},close:function(a,b){var d=c(document.getElementById(a));if(d.length)z.closeDialog(d,b);else if("$escape"===a){var e=k[k.length-1];d=c(document.getElementById(e)),d.data("$ngDialogOptions").closeByEscape&&z.closeDialog(d,"$escape")}else A.closeAll(b);return A},closeAll:function(a){for(var b=document.querySelectorAll(".ngdialog"),d=b.length-1;d>=0;d--){var e=b[d];z.closeDialog(c(e),a)}},getOpenDialogs:function(){return k},getDefaults:function(){return b}};return a.forEach(["html","body"],function(a){if(y[a]=o.find(a),i[a]){var b=z.getRouterLocationEventName();t.$on(b,function(){y[a]=o.find(a)})}}),A}]}),b.directive("ngDialog",["ngDialog",function(b){return{restrict:"A",scope:{ngDialogScope:"="},link:function(c,d,e){d.on("click",function(d){d.preventDefault();var f=a.isDefined(c.ngDialogScope)?c.ngDialogScope:"noScope";a.isDefined(e.ngDialogClosePrevious)&&b.close(e.ngDialogClosePrevious);var g=b.getDefaults();b.open({template:e.ngDialog,className:e.ngDialogClass||g.className,controller:e.ngDialogController,controllerAs:e.ngDialogControllerAs,bindToController:e.ngDialogBindToController,scope:f,data:e.ngDialogData,showClose:"false"===e.ngDialogShowClose?!1:"true"===e.ngDialogShowClose?!0:g.showClose,closeByDocument:"false"===e.ngDialogCloseByDocument?!1:"true"===e.ngDialogCloseByDocument?!0:g.closeByDocument,closeByEscape:"false"===e.ngDialogCloseByEscape?!1:"true"===e.ngDialogCloseByEscape?!0:g.closeByEscape,overlay:"false"===e.ngDialogOverlay?!1:"true"===e.ngDialogOverlay?!0:g.overlay,preCloseCallback:e.ngDialogPreCloseCallback||g.preCloseCallback})})}}}]),b});